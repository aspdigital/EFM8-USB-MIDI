C51 COMPILER V9.53.0.0   CALLBACK                                                          04/24/2019 21:28:07 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE CALLBACK
OBJECT MODULE PLACED IN .\src/callback.OBJ
COMPILER INVOKED BY: Z:\Applications\Simplicity Studio.app\Contents\Eclipse\developer\toolchains\keil_8051\9.53\BIN\C51.
                    -exe /Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/src/callback.c OMF2 SMALL DEBUG OBJECTEXTEND ROM(LARGE) WA
                    -RNINGLEVEL(2) FLOATFUZZY(3) OPTIMIZE(8,SPEED) DEFINE(DEBUG=1) INTVECTOR(0X0000) INTPROMOTE INCDIR(/Users/andy/Projects/W
                    -orkspaces/SiLabs_8051/EFM8-USB-MIDI/inc/config;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/inc;/Users/andy
                    -/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/midi;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/efm8ub
                    -2/peripheralDrivers/inc;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/efm8ub2_slstk2001a/bsp;/Users/andy
                    -/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/bsp;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/usb_aud
                    -io/inc;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/efm8_usb/inc;/Users/andy/Projects/Workspaces/SiLabs
                    -_8051/EFM8-USB-MIDI/lib/efm8_assert;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/bsp/efm8_memory_lcd/in
                    -c;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/bsp/efm8_memory_lcd/inc/config;/Users/andy/Projects/Work
                    -spaces/SiLabs_8051/EFM8-USB-MIDI/lib/bsp/efm8_memory_lcd/inc/graphics;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-U
                    -SB-MIDI/lib/bsp/efm8_joystick;/Users/andy/Projects/Workspaces/SiLabs_8051/EFM8-USB-MIDI/lib/bsp/efm8_rgb_led;/Applicatio
                    -ns/Simplicity Studio.app/Contents/Eclipse/developer/sdks/8051/v4.1.6//Device/shared/si8051Base;/Applications/Simplicity 
                    -Studio.app/Contents/Eclipse/developer/sdks/8051/v4.1.6//Device/EFM8UB2/inc) PRINT(.\src/callback.lst) COND PAGEWIDTH(120
                    -) PAGELENGTH(65) OA OBJECT(.\src/callback.OBJ)

line level    source

   1          /*******************************************************************************
   2           * @file callback.c
   3           * @brief USB Callbacks.
   4           *******************************************************************************/
   5          
   6          //=============================================================================
   7          // src/callback.c: generated by Hardware Configurator
   8          //
   9          // This file is only generated if it does not exist. Modifications in this file
  10          // will persist even if Configurator generates code. To refresh this file,
  11          // you must first delete it and then regenerate code.
  12          //=============================================================================
  13          //-----------------------------------------------------------------------------
  14          // Includes
  15          //-----------------------------------------------------------------------------
  16          #include <SI_EFM8UB2_Register_Enums.h>
  17          #include <efm8_usb.h>
  18          #include "descriptors.h"
  19          #include "rgb_led.h"
  20          #include "usb_midi.h"
  21          
  22          //-----------------------------------------------------------------------------
  23          // Constants
  24          //-----------------------------------------------------------------------------
  25          
  26          //-----------------------------------------------------------------------------
  27          // Variables
  28          //-----------------------------------------------------------------------------
  29          extern bit newIncomingPacket;
  30          extern SI_SEGMENT_VARIABLE(EndpointBuffer, MIDI_Event_Packet_t, SI_SEG_XDATA);
  31          extern SI_SEGMENT_VARIABLE(midiUsbOutPacket, MIDI_Event_Packet_t, SI_SEG_XDATA);
  32          
  33          
  34          //-----------------------------------------------------------------------------
  35          // Functions
  36          //-----------------------------------------------------------------------------
  37          
  38          void USBD_SofCb(uint16_t sofNr) {
  39   1              UNREFERENCED_ARGUMENT(sofNr);
  40   1              P3_B4 = ~P3_B4;
  41   1      }
  42          
C51 COMPILER V9.53.0.0   CALLBACK                                                          04/24/2019 21:28:07 PAGE 2   

  43          uint16_t USBD_XferCompleteCb(uint8_t epAddr, USB_Status_TypeDef status,
  44                          uint16_t xferred, uint16_t remaining) {
  45   1                UNREFERENCED_ARGUMENT(xferred);
  46   1                UNREFERENCED_ARGUMENT(remaining);
  47   1      
  48   1              if (status == USB_STATUS_OK) {
  49   2                      if (epAddr == 2) {
  50   3                              // copy contents of the endpoint buffer to the
  51   3                              // working buffer which will be parsed.
  52   3                              midiUsbOutPacket.event = EndpointBuffer.event;
  53   3                              midiUsbOutPacket.byte1 = EndpointBuffer.byte1;
  54   3                              midiUsbOutPacket.byte2 = EndpointBuffer.byte2;
  55   3                              midiUsbOutPacket.byte3 = EndpointBuffer.byte3;
  56   3                              // tell the world we have a new packet.
  57   3                              newIncomingPacket = 1;
  58   3                              // prepare for the next message packet.
  59   3                              USBD_Read(EP1OUT, (uint8_t *) &EndpointBuffer,
  60   3                                                      sizeof(MIDI_Event_Packet_t), // midi messages are four bytes
  61   3                                                      true); // we need the transfer-complete callback.
  62   3                      }
  63   2              }
  64   1              return 0;
  65   1      }
  66          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     82    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
